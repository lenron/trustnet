<!DOCTYPE HTML>
<html>

<body>

<script>
// import web cryptograpy API
var crypto = crypto.subtle;

// 1. Create custom source of entropy - From getRandomValues
var rand_entropy = new Uint8Array(16);
crypto.getRandomValues(rand_entropy);
console.log(rand_entropy);
console.log(rand_entropy[0].toString(2));
//for (var i=0; i < rand_entropy.length; i++){
//	console.log(rand_entropy[i]);
//}

// 1a. Take SHA256
async function digestValues(entropy){
	//compute checksum
	const hashBuffer = await crypto.subtle.digest('SHA-256', entropy);					// hash the message
	console.log(hashBuffer);
	const hashArray = Array.from(new Uint8Array(hashBuffer));						// convert buffer to byte array
	const hashBinArr = hashArray.map(b => b.toString(2).padStart(8, '0'));
	console.log(hashBinArr);
	const checksum = hashBinArr[0].substring(0,4);
	console.log(checksum);


	console.log(rand_entropy[0].toString(2).padStart(8, '0'));
	const entropyArray = Array.from(new Uint8Array(entropy));	// Need this since the map to string below doesn't work.
	console.log(entropyArray);
	//const entropyBinary = entropyArray.map(b => b.toString(2).padStart(8, '0')).join('');		//convert entropy to binary string
	const entropyBinaryArr = entropyArray.map(b => b.toString(2).padStart(8, '0'))
	console.log(entropyBinaryArr);
	const entropyBinary = entropyBinaryArr.join('');
	console.log(entropyBinary);
	const entropyAndChecksum = entropyBinary + checksum;
	console.log('entropy + checksum: ' + entropyAndChecksum);
	console.log(entropyAndChecksum.length);
	const splitArray = new Array;
	for(var i=0; i < entropyAndChecksum.length; i+=11){
		console.log(i)
		console.log(entropyAndChecksum.substring(i,i+11));
		splitArray.push(entropyAndChecksum.substring(i,i+11));
	}
	console.log(splitArray);

	return entropyAndChecksum;													
}

digestValues(rand_entropy).then(digested => console.log(digested))

// 2. Create a checksum of the random sequence by taking the first few bits of its SHA256 hash.

// 3. Add the checksum to the end of the random sequence.

// 4. Divide the sequence into sections of 11 bits, using those to index a dictionary of 2048 predefined words.

// 5. Produce 12 to 24 words representing the mnemonic code.


</script>

</body>

</html
